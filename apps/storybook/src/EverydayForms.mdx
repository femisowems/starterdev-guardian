import { Meta, Canvas, Controls } from '@storybook/blocks';
import * as EverydayFormsStories from './EverydayForms.stories';
import { PatternTable, PATTERN_ROWS } from './components/PatternTable';
import '../../../packages/guardian-form/src/guardian-form.css';
import './tailwind.css';

<Meta of={EverydayFormsStories} />

# Everyday Forms

Broadening the scope of `@starterdev/guardian-form` to include common, everyday form scenarios while maintaining core governance and security benefits.

## Overview

Traditional high-security forms often prioritize compliance over user experience. "Everyday Forms" bridge this gap by providing user-friendly patterns and hints for common data collection tasks like registration, contact forms, and profile updates.

## Key Features

### 1. Pattern Matching
Patterns automatically format input and apply **structural masking on blur** — separators like `-` and spaces are preserved while digits are hidden.

> `#` matches a digit · `A` matches a letter (auto-uppercased) · Other characters are used as separators

**Everyday Patterns**

<PatternTable
  rows={PATTERN_ROWS.filter(r => ['Patterns.PHONE', 'Patterns.ZIP', 'Patterns.POSTAL_CODE', 'Patterns.DOB'].includes(r.pattern))}
  title="Everyday Patterns"
  description="Common patterns for registration and contact forms."
/>

**Sensitive / Identity Patterns**

<PatternTable
  rows={PATTERN_ROWS.filter(r => ['Patterns.SSN', 'Patterns.SIN', 'Patterns.CREDIT_CARD'].includes(r.pattern))}
  title="Sensitive / Identity Patterns"
  description="For financial and identity data — always combine with HIGHLY_SENSITIVE classification and encryption."
/>

```tsx
<GuardianField name="phone" label="Phone Number" classification={DataClassification.PERSONAL} masked>
    {({ field }) => (
        <MaskedInput {...field} pattern={Patterns.PHONE} placeholder="(000) 000-0000" />
    )}
</GuardianField>
```

### 2. Privacy Hints
Transparency is key to user trust. Use the `PrivacyHint` component to explain *why* specific data is being collected.

```tsx
<GuardianField name="email" label="Email Address" classification={DataClassification.PERSONAL}>
    {({ field }) => (
        <>
            <input {...field} className="gf-input" placeholder="jane@example.com" />
            <PrivacyHint classification={DataClassification.PERSONAL} message="Used to secure your account and send updates." />
        </>
    )}
</GuardianField>
```

### 3. Data Minimization Policy
Automated enforcement of the principle of least privilege. The `DataMinimizationPolicy` warns developers if a form collects an excessive number of PII fields.

```tsx
<GuardianFormProvider
    policies={[DataMinimizationPolicy(3)]} // Limit to 3 PII fields
    ...
>
```

## Registration Examples

### US Registration
Demonstrates `PHONE`, native date picker for `DOB`, and `ZIP` patterns.

<Canvas of={EverydayFormsStories.ModernRegistration} />

### Canadian Registration
Demonstrates the `POSTAL_CODE` pattern for regional compliance.

<Canvas of={EverydayFormsStories.CanadianRegistration} />

## Properties & Configuration

<Controls />
